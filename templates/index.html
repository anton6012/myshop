{% extends "base.html" %}
{% block content %}

<div class="row mb-4">
    <div class="col-12">
        <h1 class="display-5 fw-bold">Selamat Datang di N&N Shop</h1>
        <p class="lead">Temukan produk terbaik dengan harga terjangkau</p>
    </div>
</div>

<h3 class="mb-4">Daftar Produk</h3>

{% if not produk %}
<div class="alert alert-info">
    <i class="bi bi-info-circle"></i> Belum ada produk yang tersedia.
</div>
{% endif %}

<div class="row">
    {% for p in produk %}
    <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4">
        <div class="card h-100 shadow-sm">
            <img src="{{ url_for('static', filename='uploads/' + p['foto']) if p['foto'] else 'https://via.placeholder.com/300x200?text=No+Image' }}" 
                 class="card-img-top" 
                 style="height: 200px; object-fit: cover;"
                 alt="{{ p['nama'] }}"
                 onerror="this.src='https://via.placeholder.com/300x200?text=No+Image'">
            
            <div class="card-body d-flex flex-column">
                <h6 class="card-title fw-bold">{{ p['nama'] }}</h6>
                
                {% if p['kategori'] %}
                <span class="badge bg-secondary mb-2 align-self-start">{{ p['kategori'] }}</span>
                {% endif %}
                
                <p class="card-text text-success fw-bold mb-2">{{ p['harga']|rupiah }}</p>
                
                <p class="card-text small text-muted flex-grow-1">
                    {{ p['deskripsi'][:80] }}{% if p['deskripsi']|length > 80 %}...{% endif %}
                </p>
                
                <div class="mt-auto">
                    <div class="d-grid gap-2">
                        <a href="{{ url_for('produk_detail', pid=p['id']) }}" 
                           class="btn btn-outline-primary btn-sm w-100 mb-2">Detail</a>
                        
                        {% if p['stok'] > 0 %}
                        <button class="btn btn-primary btn-sm w-100 add-cart" data-id="{{ p['id'] }}">
                            <i class="bi bi-cart-plus"></i> Tambah Keranjang
                        </button>
                        {% else %}
                        <button class="btn btn-secondary btn-sm w-100" disabled>
                            <i class="bi bi-x-circle"></i> Stok Habis
                        </button>
                        {% endif %}
                    </div>
                </div>
            </div>
            
            <div class="card-footer bg-transparent">
                <small class="text-muted">
                    Stok: 
                    <span class="fw-bold {% if p['stok'] > 10 %}text-success{% elif p['stok'] > 0 %}text-warning{% else %}text-danger{% endif %}">
                        {{ p['stok'] }}
                    </span>
                </small>
            </div>
        </div>
    </div>
    {% endfor %}
</div>

{% endblock %}